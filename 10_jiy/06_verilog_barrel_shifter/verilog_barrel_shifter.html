<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>6. Verilog实现32位桶形移位器（barrel shifter） &mdash; bluetoothlover_wiki 0.0.1 文档</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="7. FPGA基础知识分享" href="../07_fpga_base/fpga_bash.html" />
    <link rel="prev" title="5. VS Code中定位HardFault的方法" href="../05_vscode_hard_fault_debug/vscode_hard_fault_debug.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> bluetoothlover_wiki
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">BLE knowledge:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../ble/index.html">BLE STACK篇</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ble_profile/index.html">BLE PROFILE篇</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nordic/index.html">Nordic 篇</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WB55/index.html">STM32WB55 篇</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WIKI_FAQ/index.html">WIKI FAQ 篇</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../RTTHREAD/index.html">RTTHRED: RT-Thread</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../12_ESP32/index.html">ESP32</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DEBUG/index.html">EMBEDDED DEBUG 篇</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../00_supperthomas/index.html">MASTER:supperthomas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01_helloworldzlg/index.html">WB55:helloworldzlg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../02_Jackistang/index.html">WB55:Jackistang</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../03_xupenghu/index.html">WB55:xupenghu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../04_dozingfiretruck/index.html">WB55:dozingfiretruck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../05_luhuadong/index.html">WB55:luhuadong</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../09_answerinthewind/index.html">WB55:answerinthewind</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../06_chenyingchun0312/index.html">NORDIC:chenyingchun0312</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../07_ylz0923/index.html">NORDIC:ylz0923</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../08_guohp1128/index.html">NORDIC:guohp1128</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">NORDIC:jiy</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../01_introduce/01_intruduce.html">1. 简单自我介绍</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_gcc_on_vscode/gcc_on_vscode.html">2. 在VS Code上使用GCC开发嵌入式应用</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_art-pi_on_macos/art-pi_on_macos.html">3. 在MacOS下编译烧录ART-Pi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_bsp_support_dist/bsp_support_dist.html">4. RT-Thread BSP支持dist功能</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05_vscode_hard_fault_debug/vscode_hard_fault_debug.html">5. VS Code中定位HardFault的方法</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">6. Verilog实现32位桶形移位器（barrel shifter）</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">6.1. 一、提出问题和探索</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">6.2. 二、原理分析</a></li>
<li class="toctree-l3"><a class="reference internal" href="#verilog">6.3. 三、Verilog实现和仿真</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../07_fpga_base/fpga_bash.html">7. FPGA基础知识分享</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../11_ForestRain/index.html">NORDIC:ForestRain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../13_xiangxistu/index.html">NORDIC:xiangxistu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../14_bobwenstudy/index.html">NORDIC:bobwenstudy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../16_ColeStudy/index.html">NORDIC:ColeStudy</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">bluetoothlover_wiki</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">NORDIC:jiy</a></li>
      <li class="breadcrumb-item active"><span class="section-number">6. </span>Verilog实现32位桶形移位器（barrel shifter）</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/10_jiy/06_verilog_barrel_shifter/verilog_barrel_shifter.md.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="verilog32-barrel-shifter">
<h1><span class="section-number">6. </span>Verilog实现32位桶形移位器（barrel shifter）<a class="headerlink" href="#verilog32-barrel-shifter" title="此标题的永久链接"></a></h1>
<section id="id1">
<h2><span class="section-number">6.1. </span>一、提出问题和探索<a class="headerlink" href="#id1" title="此标题的永久链接"></a></h2>
<p>FPGA的教材上面有一个题是实现一个32位的桶形移位器，要求可以在一个时钟周期内对32位数进行逻辑左移、逻辑右移、算术左移、算术右移、循环左移、循环右移。</p>
<p>我当时看到这道题一脸懵逼，什么是桶形移位器？和桶有什么关系？</p>
<p>然后我上百度搜索，看到百度百科里面是这样解释的：</p>
<p><img alt="images/Untitled.png" src="../../_images/Untitled4.png" /></p>
<p>果然看完还是一脸懵逼。</p>
<p>然后我继续在网络上搜索和找好友求助，最后发现了这样一个网站：<a class="reference external" href="https://tams.informatik.uni-hamburg.de/applets/hades/webdemos/10-gates/60-barrel/shifter8.html">https://tams.informatik.uni-hamburg.de/applets/hades/webdemos/10-gates/60-barrel/shifter8.html</a></p>
<p>网站里面有一篇解释<code class="docutils literal notranslate"><span class="pre">barrel</span> <span class="pre">shifter</span></code> 如何实现的文章，看完后依然似懂非懂。但是这个网站有个非常给力的地方，它把电路的仿真做成了一个Java程序可以下载使用，这里提供了一个8位的<code class="docutils literal notranslate"><span class="pre">barrel</span> <span class="pre">shifter</span></code> 逻辑右移仿真程序，于是我把它下载了下来。</p>
</section>
<section id="id2">
<h2><span class="section-number">6.2. </span>二、原理分析<a class="headerlink" href="#id2" title="此标题的永久链接"></a></h2>
<p>启动之后，我按照网页上的说明实际操作了一下这个仿真程序，实现了从0～7位的逻辑右移，上图片：</p>
<ul>
<li><p>仿真图片（多图预警）</p>
<p><img alt="images/Untitled1.png" src="../../_images/Untitled12.png" /></p>
<p><img alt="images/Untitled2.png" src="../../_images/Untitled21.png" /></p>
<p><img alt="images/Untitled3.png" src="../../_images/Untitled31.png" /></p>
<p><img alt="images/Untitled4.png" src="../../_images/Untitled41.png" /></p>
<p><img alt="images/Untitled5.png" src="../../_images/Untitled5.png" /></p>
<p><img alt="images/Untitled6.png" src="../../_images/Untitled6.png" /></p>
<p><img alt="images/Untitled7.png" src="../../_images/Untitled7.png" /></p>
<p><img alt="images/Untitled8.png" src="../../_images/Untitled8.png" /></p>
</li>
</ul>
<p>如上图所示，<code class="docutils literal notranslate"><span class="pre">D0～D7</span></code>的数据经过三排选择器之后可以被控制位移0～7位输出到<code class="docutils literal notranslate"><span class="pre">Q0～Q7</span></code> 。每一排选择器的控制端为同一个信号<code class="docutils literal notranslate"><span class="pre">SHL_1</span></code>、<code class="docutils literal notranslate"><span class="pre">SHL_2</span></code>或<code class="docutils literal notranslate"><span class="pre">SHL_4</span></code>，其中第一排（最左边开始数）选择器实现一位右移，第二排实现两位右移，第三排实现了四位右移，即第N排实现右移$2^{N-1}$位，然后通过三排选择器的组合实现指定数量的右移。看到这里我恍然大悟，这不正是二进制数的表示方式吗？</p>
<p>在理解了桶形移位器的原理之后，我依然对<code class="docutils literal notranslate"><span class="pre">barrel</span> <span class="pre">shifter</span></code>这个名字感到困惑，这和桶有什么关系呢？</p>
<p>于是我作出了这样的猜想，如下图所示：</p>
<p><img alt="images/19051627527744_.pic_hd.jpg" src="../../_images/19051627527744_.pic_hd.jpg" /></p>
<p>红色的框框是桶，箭头是水龙头，众所周知水龙头可以打开也可以关闭。通过打开和关闭水龙头，就可以实现控制<code class="docutils literal notranslate"><span class="pre">最顶层第四个桶</span></code>里面的酒流到<code class="docutils literal notranslate"><span class="pre">最底层右边三个桶</span></code>的任意一个里面。</p>
<p>但是这样的方式显然不是最优的，因为每次只能移动一位，所以在只有3排桶的情况下，<code class="docutils literal notranslate"><span class="pre">最顶层第四个桶</span></code> 里面的酒无论如何都流不到<code class="docutils literal notranslate"><span class="pre">最底层第一个桶</span></code>里面。</p>
<p>于是稍作调整之后产生了优化过后的“酒桶图”：</p>
<p><img alt="images/Untitled9.png" src="../../_images/Untitled9.png" /></p>
<p>在这个图里，<code class="docutils literal notranslate"><span class="pre">顶层右边的酒桶</span></code>就可以流到<code class="docutils literal notranslate"><span class="pre">底层和自己同一列或者在自己左边</span></code> 的任意桶内，把这里的桶、水龙头、酒分别替换成电路里面的的选择器、电路、电平信号就成了<code class="docutils literal notranslate"><span class="pre">左移的逻辑位移器</span></code>。如果要实现算术位移、循环位移只是接法略有区别，原理是一样的。</p>
</section>
<section id="verilog">
<h2><span class="section-number">6.3. </span>三、Verilog实现和仿真<a class="headerlink" href="#verilog" title="此标题的永久链接"></a></h2>
<ul>
<li><p>实现代码</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="no">`timescale</span><span class="w"> </span><span class="mh">1</span><span class="n">ns</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mh">1</span><span class="n">ps</span><span class="w"></span>

<span class="k">module</span><span class="w"> </span><span class="n">barrelShifter</span><span class="p">(</span><span class="w"></span>
<span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"></span>
<span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"></span>
<span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="k">type</span><span class="p">,</span><span class="w"></span>
<span class="k">input</span><span class="w"> </span><span class="n">direction</span><span class="p">,</span><span class="w"></span>
<span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">len</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>

<span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="k">case</span><span class="p">(</span><span class="k">type</span><span class="p">)</span><span class="w"></span>
<span class="w">		</span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="o">:</span><span class="w">  </span><span class="c1">// logic shifter</span>
<span class="w">			</span><span class="k">begin</span><span class="w"></span>
<span class="w">				</span><span class="k">if</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span><span class="w"></span>
<span class="w">					</span><span class="k">begin</span><span class="w">  </span><span class="c1">// right</span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">1</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">2</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">4</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">4</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">8</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">8</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="mh">16</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">16</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">					</span><span class="k">end</span><span class="w"></span>
<span class="w">				</span><span class="k">else</span><span class="w"></span>
<span class="w">					</span><span class="k">begin</span><span class="w">  </span><span class="c1">// left</span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">data</span><span class="p">[</span><span class="mh">30</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">29</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">27</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">4</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">23</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">8</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">16</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">					</span><span class="k">end</span><span class="w"></span>
<span class="w">			</span><span class="k">end</span><span class="w"></span>
<span class="w">		</span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="o">:</span><span class="w">  </span><span class="c1">// arithmetic shifter</span>
<span class="w">			</span><span class="k">begin</span><span class="w"> </span>
<span class="w">				</span><span class="k">if</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span><span class="w"></span>
<span class="w">					</span><span class="k">begin</span><span class="w">  </span><span class="c1">// right</span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">data</span><span class="p">[</span><span class="mh">31</span><span class="p">],</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">1</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{{</span><span class="mh">2</span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="p">]}},</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">2</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{{</span><span class="mh">4</span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="p">]}},</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">4</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{{</span><span class="mh">8</span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="p">]}},</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">8</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{{</span><span class="mh">16</span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="p">]}},</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">16</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">					</span><span class="k">end</span><span class="w"></span>
<span class="w">				</span><span class="k">else</span><span class="w"></span>
<span class="w">					</span><span class="k">begin</span><span class="w">  </span><span class="c1">// left</span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">data</span><span class="p">[</span><span class="mh">30</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">29</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">27</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">4</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">23</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">8</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="mh">16</span><span class="mb">&#39;b0</span><span class="p">}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">					</span><span class="k">end</span><span class="w"></span>
<span class="w">			</span><span class="k">end</span><span class="w"></span>
<span class="w">		</span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="o">:</span><span class="w">  </span><span class="c1">// cyclic shifter</span>
<span class="w">			</span><span class="k">begin</span><span class="w"></span>
<span class="w">				</span><span class="k">if</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span><span class="w"></span>
<span class="w">					</span><span class="k">begin</span><span class="w">  </span><span class="c1">// right</span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">data</span><span class="p">[</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">1</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">2</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">4</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">8</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">16</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">					</span><span class="k">end</span><span class="w"></span>
<span class="w">				</span><span class="k">else</span><span class="w"></span>
<span class="w">					</span><span class="k">begin</span><span class="w">  </span><span class="c1">// left</span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">data</span><span class="p">[</span><span class="mh">30</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="n">data</span><span class="p">[</span><span class="mh">31</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">29</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">30</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">27</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">28</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">23</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">24</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">						</span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="n">out</span><span class="p">[</span><span class="mh">15</span><span class="o">:</span><span class="mh">0</span><span class="p">],</span><span class="w"> </span><span class="n">out</span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">16</span><span class="p">]}</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>
<span class="w">					</span><span class="k">end</span><span class="w"></span>
<span class="w">			</span><span class="k">end</span><span class="w"></span>
<span class="w">	</span><span class="k">endcase</span><span class="w"></span>

<span class="k">endmodule</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p>仿真代码</p>
<p>逻辑左移：</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="no">`timescale</span><span class="w"> </span><span class="mh">1</span><span class="n">ns</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mh">1</span><span class="n">ps</span><span class="w"></span>

<span class="k">module</span><span class="w"> </span><span class="n">test_logic_shifter_left</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Inputs</span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="k">type</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="n">direction</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Outputs</span>
<span class="w">	</span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Instantiate the Unit Under Test (UUT)</span>
<span class="w">	</span><span class="n">barrelShifter</span><span class="w"> </span><span class="n">uut</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">		</span><span class="p">.</span><span class="n">out</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">data</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="k">type</span><span class="p">(</span><span class="k">type</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">direction</span><span class="p">(</span><span class="n">direction</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">len</span><span class="p">(</span><span class="n">len</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span><span class="w"></span>
<span class="w">		</span><span class="c1">// Initialize Inputs</span>
<span class="w">		</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="p">{</span><span class="mh">32</span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">}};</span><span class="w"></span>
<span class="w">		</span><span class="k">type</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">direction</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">len</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">end</span><span class="w"></span>

<span class="w">	</span><span class="k">always</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"></span>

<span class="k">endmodule</span><span class="w"></span>
</pre></div>
</div>
<p>逻辑右移：</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="no">`timescale</span><span class="w"> </span><span class="mh">1</span><span class="n">ns</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mh">1</span><span class="n">ps</span><span class="w"></span>

<span class="k">module</span><span class="w"> </span><span class="n">test_logic_shifter_right</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Inputs</span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="k">type</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="n">direction</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Outputs</span>
<span class="w">	</span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Instantiate the Unit Under Test (UUT)</span>
<span class="w">	</span><span class="n">barrelShifter</span><span class="w"> </span><span class="n">uut</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">		</span><span class="p">.</span><span class="n">out</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">data</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="k">type</span><span class="p">(</span><span class="k">type</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">direction</span><span class="p">(</span><span class="n">direction</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">len</span><span class="p">(</span><span class="n">len</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span><span class="w"></span>
<span class="w">		</span><span class="c1">// Initialize Inputs</span>
<span class="w">		</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">32</span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">}};</span><span class="w"></span>
<span class="w">		</span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">end</span><span class="w"></span>

<span class="w">	</span><span class="k">always</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"></span>

<span class="k">endmodule</span><span class="w"></span>
</pre></div>
</div>
<p>算术左移:</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="no">`timescale</span><span class="w"> </span><span class="mh">1</span><span class="n">ns</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mh">1</span><span class="n">ps</span><span class="w"></span>

<span class="k">module</span><span class="w"> </span><span class="n">test_arithmetic_shifter_left</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Inputs</span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="k">type</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="n">direction</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Outputs</span>
<span class="w">	</span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Instantiate the Unit Under Test (UUT)</span>
<span class="w">	</span><span class="n">barrelShifter</span><span class="w"> </span><span class="n">uut</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">		</span><span class="p">.</span><span class="n">out</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">data</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="k">type</span><span class="p">(</span><span class="k">type</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">direction</span><span class="p">(</span><span class="n">direction</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">len</span><span class="p">(</span><span class="n">len</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span><span class="w"></span>
<span class="w">		</span><span class="c1">// Initialize Inputs</span>
<span class="w">		</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="p">{</span><span class="mh">32</span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">}};</span><span class="w"></span>
<span class="w">		</span><span class="k">type</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">direction</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">len</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">end</span><span class="w"></span>

<span class="w">	</span><span class="k">always</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"></span>

<span class="k">endmodule</span><span class="w"></span>
</pre></div>
</div>
<p>算术右移:</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="no">`timescale</span><span class="w"> </span><span class="mh">1</span><span class="n">ns</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mh">1</span><span class="n">ps</span><span class="w"></span>

<span class="k">module</span><span class="w"> </span><span class="n">test_arithmetic_shifter_right</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Inputs</span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="k">type</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="n">direction</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Outputs</span>
<span class="w">	</span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Instantiate the Unit Under Test (UUT)</span>
<span class="w">	</span><span class="n">barrelShifter</span><span class="w"> </span><span class="n">uut</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">		</span><span class="p">.</span><span class="n">out</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">data</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="k">type</span><span class="p">(</span><span class="k">type</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">direction</span><span class="p">(</span><span class="n">direction</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">len</span><span class="p">(</span><span class="n">len</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span><span class="w"></span>
<span class="w">		</span><span class="c1">// Initialize Inputs</span>
<span class="w">		</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="p">{{</span><span class="mh">16</span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">}},</span><span class="w"> </span><span class="p">{</span><span class="mh">16</span><span class="p">{</span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">}}};</span><span class="w"></span>
<span class="w">		</span><span class="k">type</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">direction</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">len</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">end</span><span class="w"></span>

<span class="w">	</span><span class="k">always</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"></span>

<span class="k">endmodule</span><span class="w"></span>
</pre></div>
</div>
<p>循环左移:</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="no">`timescale</span><span class="w"> </span><span class="mh">1</span><span class="n">ns</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mh">1</span><span class="n">ps</span><span class="w"></span>

<span class="k">module</span><span class="w"> </span><span class="n">test_cyclic_shifter_left</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Inputs</span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="k">type</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="n">direction</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Outputs</span>
<span class="w">	</span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Instantiate the Unit Under Test (UUT)</span>
<span class="w">	</span><span class="n">barrelShifter</span><span class="w"> </span><span class="n">uut</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">		</span><span class="p">.</span><span class="n">out</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">data</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="k">type</span><span class="p">(</span><span class="k">type</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">direction</span><span class="p">(</span><span class="n">direction</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">len</span><span class="p">(</span><span class="n">len</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span><span class="w"></span>
<span class="w">		</span><span class="c1">// Initialize Inputs</span>
<span class="w">		</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="p">{</span><span class="mh">8</span><span class="p">{</span><span class="mh">4</span><span class="mb">&#39;b0001</span><span class="p">}};</span><span class="w"></span>
<span class="w">		</span><span class="k">type</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">direction</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">len</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">end</span><span class="w"></span>

<span class="w">	</span><span class="k">always</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"></span>

<span class="k">endmodule</span><span class="w"></span>
</pre></div>
</div>
<p>循环右移:</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="no">`timescale</span><span class="w"> </span><span class="mh">1</span><span class="n">ns</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mh">1</span><span class="n">ps</span><span class="w"></span>

<span class="k">module</span><span class="w"> </span><span class="n">test_cyclic_shifter_right</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Inputs</span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="k">type</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="n">direction</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">4</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Outputs</span>
<span class="w">	</span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">out</span><span class="p">;</span><span class="w"></span>

<span class="w">	</span><span class="c1">// Instantiate the Unit Under Test (UUT)</span>
<span class="w">	</span><span class="n">barrelShifter</span><span class="w"> </span><span class="n">uut</span><span class="w"> </span><span class="p">(</span><span class="w"></span>
<span class="w">		</span><span class="p">.</span><span class="n">out</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">data</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="k">type</span><span class="p">(</span><span class="k">type</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">direction</span><span class="p">(</span><span class="n">direction</span><span class="p">),</span><span class="w"> </span>
<span class="w">		</span><span class="p">.</span><span class="n">len</span><span class="p">(</span><span class="n">len</span><span class="p">)</span><span class="w"></span>
<span class="w">	</span><span class="p">);</span><span class="w"></span>

<span class="w">	</span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span><span class="w"></span>
<span class="w">		</span><span class="c1">// Initialize Inputs</span>
<span class="w">		</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="p">{</span><span class="mh">8</span><span class="p">{</span><span class="mh">4</span><span class="mb">&#39;b0001</span><span class="p">}};</span><span class="w"></span>
<span class="w">		</span><span class="k">type</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">direction</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"></span>
<span class="w">		</span><span class="n">len</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"></span>
<span class="w">	</span><span class="k">end</span><span class="w"></span>

<span class="w">	</span><span class="k">always</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"></span>

<span class="k">endmodule</span><span class="w"></span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="../05_vscode_hard_fault_debug/vscode_hard_fault_debug.html" class="btn btn-neutral float-left" title="5. VS Code中定位HardFault的方法" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="../07_fpga_base/fpga_bash.html" class="btn btn-neutral float-right" title="7. FPGA基础知识分享" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2020, apache.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>